teams={AAHE:"Alliance Aischdall Hobscheid/Eischen",ADUD:"Alliance Dudelange",AFLX:"Avenir Flaxweiler",AHOS:"AS Hosingen",ALLX:"Alliance 01 Luxemburg",
    AMRS:"Amis de la Moselle Remerschen",ARBD:"Arantia Berdorf",AREM:"AS Remich",ARIS:"Aris Bonnevoie",ASCB:"AS Colmar-Berg",ASCH:"AS Schifflange",
    ASDF:"AS Differdange",ASLX:"AS Luxembourg",ASTN:"Alisontia Steinsel",ATBS:"Atert Bissen",AVBG:"Avenir Beggen",AWDG:"Arminia Weidingen",BAST:"FC 47 Bastendorf",
    BBML:"Blue Boys Muhlenbach",BDBB:"Berdenia Berbourg",BENF:"RM Hamm Benfica",BIEK:"FC Biekerech",BGHP:"Blo-Giel Hupperdange",BGNV:"FC Bigonville",
    BLVL:"The Belval Belvaux",BOUS:"US Bous",BRAC:"Bracarense Grund",BRCH:"FC Brouch",BVAT:"US Boevange/Attert",BWIT:"Blo-Wäiss Itzig",BWMD:"Blo-Wäiss Medernach",
    BYUD:"FC Beyren-Udinesina",CBRA:"Cebra 01",CBSH:"CS Bourscheid",CECH:"CS Echternach",CESS:"Cessange FC",CGRV:"CS Grevenmacher",CLMC:"ES Clemency",
    CLVX:"Claravallis Clervaux",CMLB:"CS Mondorf-les-Bains",CSHL:"CS Hollerich",CPET:"CS Petange",CROD:"Chiers Rodange",CSOB:"CS Oberkorn",DARE:"Daring Club Echternach",
    DEIC:"Daring Club Eich",DIFF:"Differdange 03",DRZV:"Diables Rouges Zolver",ECBT:"Eclair Bettembourg",EBDU:"Etoile Bleu Dudelange",EGWM:"Egalité Weimerskirch",
    EHLR:"FC Ehlerange",ERDU:"Etoile Rouge 1908 Dudelange",ERPL:"FC Erpeldange 72",ESHW:"ES Schouweiler",ESLX:"Etoile Sportive Luxembourg",ETZE:"Etzella Ettelbréck",
    EXGV:"Excelsior Grevels",F91D:"F91 Dudelange",FBU1:"Flaxweiler/Beyren Udinesina 01",FCOB:"FC Oberkorn",FCPR:"FC Pratzerthal/Rédange",FOLA:"Fola Esch",
    FOLS:"US Folschette",FRTA:"Forta Beaufort",GBHT:"GB Harlange/Tarchamps",GDLL:"Grupo Desportivo dos Lusitanos de Larochette",GDUD:"Gallia Dudelange",
    GOLD:"Gold a Ro't Wiltz",GSWW:"Green Star Wilwerdingen",HAMM:"FC Hamm 37",HARL:"FC Harlange",HLBN:"US Hollerich/Bonnevoie",HOBS:"CS Hobscheid",
    HOST:"US Hostert",HUPP:"FC Hupperdange",ISKA:"Iska Boys Simmern",JBET:"Jeunesse Bettembourg",JBIW:"Jeunesse Biwer",JCNC:"Jeunesse Canach",JECT:"Jeunesse Echternach",
    JESH:"Jeunesse Esch",JGIL:"Jeunesse Gilsdorf",JHSD:"Jeunesse Heisdorf",JHTC:"Jeunesse Hautcharage",JKYL:"Jeunesse 07 Kayl",JOSP:"Jeunesse Ospern",
    JSCH:"Jeunesse Schieren",JSKH:"Jeunesse Sportive Koerich",JSTF:"Jeunesse Steinfort",JUNG:"Jeunesse Junglinster",JUSE:"Jeunesse Useldange",
    JVRL:"Jeunesse Verlorenkost",JWAS:"Jeunesse Wasserbillig",JWMK:"Jeunesse Weimerskirch",JWIL:"Jeunesse Wilwerdingen",KAER:"UN Käerjéng 97",KHLN:"FC Kehlen",
    KNAP:"FC Knaphoscheid/Selscheid",KOEP:"FC Koeppchen",KOPS:"FC Kopstal 33",KOSM:"FC Koerich",KPWW:"Kiischpelt Wilwerwiltz",KWRM:"Koeppchen Wormeldange",
    LADH:"Les Aiglons Dalheim",LARD:"Les Ardoisiers Perlé",LRNZ:"FC Lorentzweiler",LUNA:"Luna Oberkorn",LUXC:"FC Luxembourg City",MAMR:"Mamer 32",
    MANC:"Mansfeldia Clausen",MARM:"Marisca Mersch",MDCG:"FC Mondercange",MDLB:"US Mondorf-les-Bains",MGWW:"Les Montagnards Weiswampach",MINL:"Minerva Lintgen",
    MLSV:"Minière Lasauvage",MRTZ:"Sporting Mertzig",MUNS:"FC Munsbach",NESH:"National Esch",NORD:"FF Norden 02",NORZ:"FC Noertzange HF",NSCH:"National Schifflange",
    OBCN:"Old Boys Consdorf",OVND:"Orania Vianden",OYCW:"Olympia Christnach/Waldbillig",OYMP:"Olympique Äischen",PHLK:"Phalanx Kleinbettingen",PRTZ:"AS Pratzerthal",
    PROC:"Progrès Cessange",PROG:"Progrès Grund",PRON:"Progrès Niederkorn",RACE:"Racing Union",RACL:"Racing Club Luxembourg",RAMB:"US Rambrouch",RBAS:"Red Boys Aspelt",
    RBDF:"Red Boys Differdange",RBE7:"Red Black-Egalité 07",RBPF:"Red Black Pfaffenthal",REIS:"US Reisdorf",RHDS:"Racing Heiderscheid",RHSE:"Racing Heiderscheid/Eschdorf",
    RLCN:"Ro'de Le'w Consthum",RMHM:"FC RM Hamm Benfica",RMLX:"RM 86 Luxembourg",RODG:"FC Rodange 91",ROLG:"CS Rollingergrund",RPDN:"Rapid Neudorf",
    RPLL:"Rupensia Lusitanos Larochette",RROD:"Racing Rodange",RSMB:"Red Star Merl/Belair",RSML:"Red Star Merl",RUPL:"Rupensia Larochette",SAND:"US Sandweiler",
    SBCK:"Sporting Beckerich",SBRT:"Sporting Bertrange",SCBT:"SC Bettembourg",SCHF:"Schifflange 95",SCLX:"SC Luxembourg",SDIF:"SC Differdange",SDUD:"Stade Dudelange",
    SELL:"SC Ell",SHGN:"FC Schengen",SMOB:"Saint Michel Oberpallen",SNEM:"CS Sanem",SPDD:"Sparta Dudelange",SPOR:"Spora Luxembourg",SPST:"Sporting Steinfort",
    SRED:"SC Rédange",STNG:"FC Stengefort",STET:"SC Tétange",SURA:"Sura Esch/Sauer",SWFT:"Swift Hesperange",SYRA:"Syra Mensdorf",TLMD:"Titus Lamadelaine",
    TRIG:"Tricolore Gasperich",TRIM:"Tricolore Muhlenweg",TSVG:"Racing Troisvierges",TWTC:"Tarwat Tarchamps",U5KT:"Union 05 Kayl/Tétange",UBSH:"US Bascharage",
    UEDF:"US Eschdorf",UESH:"US Esch",UFLN:"US Feulen",ULUX:"Union Luxembourg",UMRT:"US Mertert",UNAS:"UNA Strassen",UNMW:"Union Mertert/Wasserbillig",
    UNRB:"Union Remich/Bous",UNTP:"Union Titus Petange",URUM:"US Rumelange",USBC:"US Berdorf/Consdorf",USDD:"US Dudelange",USMM:"US Moutfort/Medingen",
    USND:"US Niederwiltz",VICR:"Victoria Rosport",VINE:"Vinesca Ehnen",WALF:"Résidence Walferdange",WINC:"AS Wincrange",WLTZ:"FC Wiltz 71",WWMP:"FC Weiswampach",
    YBDK:"Young Boys Diekirch",YBWT:"Yellow Boys Weiler-la-Tour",YGGC:"Yougo Grund-Cessange",YBSW:"Young Boys Schweicherthal"};

function buildGraph() {
    leagueSizes = [];
	clubs = {};
	seasons = 0;

	function loadSeason(t1=[],t2=[],t3=[]) {
		leagueSizes.push( [t1.length,t2.length,t3.length] );
		p = 1;
		t1.forEach(c1=>{
			if ( !clubs[c1] ) {
				clubs[c1] = [];
				for ( i=1 ; i<=seasons ; i++ ) {
					clubs[c1].push( null );
				}
			}
			clubs[c1].push(p);
			p++;
		});
		t2.forEach(c2=>{
			c2.split("|").forEach(cc2=>{
				if ( !clubs[cc2] ) {
					clubs[cc2] = [];
					for ( i=1 ; i<=seasons ; i++ ) {
						clubs[cc2].push( null );
					}
				}
				clubs[cc2].push(p);
			});
			p++;
		});
		t3.forEach(c3=>{
			c3.split("|").forEach(cc3=>{
				if ( !clubs[cc3] ) {
					clubs[cc3] = [];
					for ( i=1 ; i<=seasons ; i++ ) {
						clubs[cc3].push( null );
					}
				}
				clubs[cc3].push(p);
			});
			p++;
		});
		t4.forEach(c4=>{
			c4.split("|").forEach(cc4=>{
				if ( !clubs[cc4] ) {
					clubs[cc4] = [];
					for ( i=1 ; i<=seasons ; i++ ) {
						clubs[cc4].push( null );
					}
				}
				clubs[cc4].push(p);
			});
			p++;
		});
		seasons ++;
		Object.keys(clubs).forEach(c=>{
			if ( clubs[c].length !== seasons ) {
				clubs[c].push( null );
			}
		});
	}
	function loadSeason191415(winner="",t1=[]) {
		leagueSizes.push( [t1.length] );
		p = 1;
		t1.forEach(c1=>{
			c1.split("|").forEach(cc1=>{
				if ( !clubs[cc1] ) {
					clubs[cc1] = [];
					for ( i=1 ; i<=seasons ; i++ ) {
						clubs[cc1].push( null );
					}
				}
				if ( p === 1 && cc1 !== winner ) {
					clubs[cc1].push(1.5);
				} else {
					clubs[cc1].push(p);
				}
			});
			p++;
		});
		seasons ++;
		Object.keys(clubs).forEach(c=>{
			if ( clubs[c].length !== seasons ) {
				clubs[c].push( null );
			}
		});
	}

	/*1909-10*/ loadSeason(["RACL","HLBN","SCLX","JESH","URUM","JECT","CROD","NESH","GDUD"]);
	/*1910-11*/ loadSeason(["SCLX","SDIF","HLBN","MANC"]);
	/*1911-12*/ loadSeason(["HLBN","SCLX","RACL","DEIC"]);
	/*1912-13*/ loadSeason([]);
	/*1913-14*/ loadSeason(["HLBN","SCLX","RACL","SDIF","JESH","CPET"]);
	/*1914-15*/ loadSeason191415("HLBN",["HLBN|SCLX|JESH|SDUD|CPET|YBDK","RACL|FOLA|USDD|SDIF|CECH"]);
	/*1915-16*/ loadSeason(["HLBN","SCLX","FOLA","RACL","JESH","SDUD"],["YBDK","SDIF","CPET"],["CSHL|JBET","JSTF|NSCH","ROLG|ERDU"]);
	/*1916-17*/ loadSeason(["HLBN","FOLA","RACL","SCLX","YBDK","JESH"],["CPET","SDIF","SDUD","CSHL","UESH"],["AVBG|URUM","JWMK|NSCH","WALF|STET","ROLG|BLVL"]);
	/*1917-18*/ loadSeason(["FOLA","HLBN","SCLX","YBDK","RACL","CPET"],["JESH","SDIF","SDUD","URUM","CSHL"],["AVBG|STET","CMLB|ECBT","JWMK|NSCH","ADUD"]);
	/*1918-19*/ loadSeason(["SCLX","FOLA","JESH","HLBN","RACL","YBDK"],["SDUD","SDIF","AVBG","URUM","CPET"],["CMLB|CROD","ETZE|NSCH","SWFT|ECBT","CLMC|STET","ADUD"]);
	/*1919-20*/ loadSeason(["FOLA","SDUD","SCLX","HLBN","JESH","RACL"],["RBDF","URUM","NSCH","CROD","CPET","AVBG"],["PROG|BLVL|JSTF","TRIM|STET|PRON","MANC|ADUD|JHTC","CSHL|UESH|ETZE","JVRL|ECBT|CLMC","WALF","CMLB"]);
	/*1920-21*/ loadSeason(["JESH","FOLA","HLBN","SDUD","RBDF","SCLX","RACL","URUM"],["TRIM","NSCH","CROD","PROG","CPET","JSTF","AVBG","BLVL"],["STET","UESH","PRON","CSHL","ADUD","MANC","ETZE","JHTC"],["RBPF|ECBT|FCOB","ASLX|USDD|OYMP","JWAS|IESH|BBOY","JVRL|ENFM|HAGN","MERL|JMON|YBSL","SWFT|JSNM"]);

	t1d = "M45,69";
	t2d = "M105,69";
	t3d = "M105,69";
	t4d = "M105,69"; // adjust 105
	t5d = "M105,69"; // adjust 105
	t1s = 0;
	t2s = 0;
	t3s = 0;
	t4s = 0;
	t5s = 0;
	leagueSizes.forEach(s=>{

		one = s[0];
		two = s.length >= 2 && s[1] !== 0 ? one + s[1] : null;
		three = s.length >= 3 && s[2] !== 0  ? two + s[2] : null;
		four = s.length >= 4 && s[3] !== 0  ? (three + s[3]) : null;
		five = s.length >= 5 && s[4] !== 0  ? (four + s[4]) : null;

		if ( t1s === 0 ) {
			t1d += "v" + (one*4) + "h10";
			t1s = one;
		} else if ( t1s === one ) {
			t1d += "h10";
		} else if ( t1s > one ) {
			diff = one - t1s;
			t1d += "v" +( diff*4 ) + "h10";
			t1s = one;
		} else if ( t1s < one ) {
			diff = one - t1s;
			t1d += "v" +( diff*4 ) + "h10";
			t1s = one;
		}

		if ( two ) {
			if ( t2s === 0 ) {
				t2d += "v" +( two*4) + "h10";
				t2s = two;
			} else if ( t2s === two ) {
				t2d += "h10";
			} else if ( t2s > two ) {
				diff = two - t2s;
				t2d += "v" +( diff*4 ) + "h10";
				t2s = two;
			} else if ( t2s < two ) {
				diff = two - t2s;
				t2d += "v" +( diff*4 ) + "h10";
				t2s = two;
			}
		}

		if ( three ) {
			if ( t3s === 0 ) {
				t3d += "v" +( three*4) + "h10";
				t3s = three;
			} else if ( t3s === three ) {
				t3d += "h10";
			} else if ( t3s > three ) {
				diff = three - t3s;
				t3d += "v" +( diff*4 ) + "h10";
				t3s = three;
			} else if ( t3s < three ) {
				diff = three - t3s;
				t3d += "v" +( diff*4 ) + "h10";
				t3s = three;
			}
		}

		if ( four ) {
			if ( t4s === 0 ) {
				t4d += "v" +( four*4) + "h10";
				t4s = four;
			} else if ( t4s === four ) {
				t4d += "h10";
			} else if ( t4s > four ) {
				diff = four - t4s;
				t4d += "v" +( diff*4 ) + "h10";
				t4s = four;
			} else if ( t4s < four ) {
				diff = four - t4s;
				t4d += "v" +( diff*4 ) + "h10";
				t4s = four;
			}
		}

		if ( five ) {
			if ( t5s === 0 ) {
				t5d += "v" +( five*4) + "h10";
				t5s = five;
			} else if ( t5s === five ) {
				t5d += "h10";
			} else if ( t5s > five ) {
				diff = five - t5s;
				t5d += "v" +( diff*4 ) + "h10";
				t5s = five;
			} else if ( t5s < five ) {
				diff = five - t5s;
				t5d += "v" +( diff*4 ) + "h10";
				t5s = five;
			}
		}

	});

	t1d += "v-"+(t1s*4)+"H45";
	t2d += "v-"+(t2s*4)+"H45";
	t3d += "v-"+(t3s*4)+"H45";
	t4d += "v-"+(t4s*4)+"H45";
	t5d += "v-"+(t5s*4)+"H45";
	document.getElementById("t1").setAttribute("d",t1d);
	document.getElementById("t2").setAttribute("d",t2d);
	document.getElementById("t3").setAttribute("d",t3d);
	document.getElementById("t4").setAttribute("d",t4d);
	document.getElementById("t5").setAttribute("d",t5d);

	focus = urlParams["club"].toUpperCase();
	team = clubs[focus];
	teamName = teams[focus];
	start = 50;
	p0 = 73 -4;
	line = "";
	started = false;
	current = p0;
	gap = 10;
	consecutive = 0;
	team.forEach(position=>{
		if ( position === null ) {
			if ( started ) {
				if ( consecutive === 1 ) {
					line += "l2,0";
					gap += 8;
				} else {
					gap += 10;
				}
			} else {
				start += 10;
			}
			consecutive = 0;
		} else {
			place = p0 + (position*4);
			if ( gap !== 10 ) {
				line += "m"+gap;
				diff = place - current;
				line += ","+diff;
				gap = 10;
			} else {
				if ( ! started ) {
					line += "M"+start+","+place;
					started = true;
				} else {
					diff = place - current;
					line += "l10,"+diff;
				}
			}
			current = place;
			consecutive++;
		}
	});
	if ( consecutive === 1 ) {
		line += "l2,0";
	}
	document.getElementById("POS").setAttribute("d",line);
	document.getElementById("title").innerHTML = teamName + " league history 1909-2025";
}

$(document).ready(function(){
	if ( urlParams["club"] ) {
    	buildGraph();
	}
});